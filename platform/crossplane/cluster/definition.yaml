apiVersion: apiextensions.crossplane.io/v1
kind: CompositeResourceDefinition
metadata:
  name: compositeclusters.multicloud.platformref.yurikrupnik.com
spec:
  claimNames:
    kind: Cluster
    plural: clusters
  group: multicloud.platformref.yurikrupnik.com
  names:
    kind: CompositeCluster
    plural: compositeclusters
  versions:
    - name: v1alpha1
      served: true
      referenceable: true
      schema:
        openAPIV3Schema:
          type: object
          properties:
            spec:
              type: object
              properties:
                id:
                  type: string
                  description: ID of this Cluster that other objects can refer.
                parameters:
                  type: object
                  description: Parameters used to customize the cluster
                  properties:
                    version:
                      description: The Kubernetes version for the cluster.
                      type: string
                    nodeSize:
                      description: The size of the nodes; small, medium, large.
                      type: string
                      default: small
                    minNodeCount:
                      description: The minimum number of nodes.
                      type: integer
                      default: 1
                    namespaces:
                      description: List of Namespaces that should be created in the cluster
                      type: array
                      items:
                        type: string
                      default:
                        - dev
                        - production
                    # TODO: Uncomment and implement
                    # apps:
                    #   type: object
                    #   description: List of apps that should be installed in the cluster
                    #   properties:
                    #     crossplane:
                    #       description: Install Crossplane
                    #       type: boolean
                    #       default: false
                  required:
                    - nodeSize
              required:
                - id
                - parameters
            status:
              type: object
              properties:
                clusterName:
                  description: The name of the cluster.
                  type: string
                controlPlaneStatus:
                  description: The status of the control plane.
                  type: string
                nodePoolStatus:
                  description: The status of the node pool.
                  type: string
                field1:
                  description: A placeholder
                  type: string
      additionalPrinterColumns:
        - name: clusterName
          type: string
          jsonPath: ".status.clusterName"
        - name: controlPlane
          type: string
          jsonPath: ".status.controlPlaneStatus"
        - name: nodePool
          type: string
          jsonPath: ".status.nodePoolStatus"
