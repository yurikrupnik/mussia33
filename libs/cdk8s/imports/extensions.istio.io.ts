// generated by cdk8s
import { ApiObject, ApiObjectMetadata, GroupVersionKind } from 'cdk8s';
import { Construct } from 'constructs';


/**
 *
 *
 * @schema WasmPlugin
 */
export class WasmPlugin extends ApiObject {
  /**
   * Returns the apiVersion and kind for "WasmPlugin"
   */
  public static readonly GVK: GroupVersionKind = {
    apiVersion: 'extensions.istio.io/v1alpha1',
    kind: 'WasmPlugin',
  }

  /**
   * Renders a Kubernetes manifest for "WasmPlugin".
   *
   * This can be used to inline resource manifests inside other objects (e.g. as templates).
   *
   * @param props initialization props
   */
  public static manifest(props: WasmPluginProps = {}): any {
    return {
      ...WasmPlugin.GVK,
      ...toJson_WasmPluginProps(props),
    };
  }

  /**
   * Defines a "WasmPlugin" API object
   * @param scope the scope in which to define this object
   * @param id a scope-local name for the object
   * @param props initialization props
   */
  public constructor(scope: Construct, id: string, props: WasmPluginProps = {}) {
    super(scope, id, {
      ...WasmPlugin.GVK,
      ...props,
    });
  }

  /**
   * Renders the object to Kubernetes JSON.
   */
  public toJson(): any {
    const resolved = super.toJson();

    return {
      ...WasmPlugin.GVK,
      ...toJson_WasmPluginProps(resolved),
    };
  }
}

/**
 * @schema WasmPlugin
 */
export interface WasmPluginProps {
  /**
   * @schema WasmPlugin#metadata
   */
  readonly metadata?: ApiObjectMetadata;

  /**
   * Extend the functionality provided by the Istio proxy through WebAssembly filters. See more details at: https://istio.io/docs/reference/config/proxy_extensions/wasm-plugin.html
   *
   * @schema WasmPlugin#spec
   */
  readonly spec?: WasmPluginSpec;

}

/**
 * Converts an object of type 'WasmPluginProps' to JSON representation.
 */
/* eslint-disable max-len, quote-props */
export function toJson_WasmPluginProps(obj: WasmPluginProps | undefined): Record<string, any> | undefined {
  if (obj === undefined) { return undefined; }
  const result = {
    'metadata': obj.metadata,
    'spec': toJson_WasmPluginSpec(obj.spec),
  };
  // filter undefined values
  return Object.entries(result).reduce((r, i) => (i[1] === undefined) ? r : ({ ...r, [i[0]]: i[1] }), {});
}
/* eslint-enable max-len, quote-props */

/**
 * Extend the functionality provided by the Istio proxy through WebAssembly filters. See more details at: https://istio.io/docs/reference/config/proxy_extensions/wasm-plugin.html
 *
 * @schema WasmPluginSpec
 */
export interface WasmPluginSpec {
  /**
   * @schema WasmPluginSpec#imagePullPolicy
   */
  readonly imagePullPolicy?: WasmPluginSpecImagePullPolicy;

  /**
   * Credentials to use for OCI image pulling.
   *
   * @schema WasmPluginSpec#imagePullSecret
   */
  readonly imagePullSecret?: string;

  /**
   * Specifies the criteria to determine which traffic is passed to WasmPlugin.
   *
   * @schema WasmPluginSpec#match
   */
  readonly match?: WasmPluginSpecMatch[];

  /**
   * Determines where in the filter chain this `WasmPlugin` is to be injected.
   *
   * @schema WasmPluginSpec#phase
   */
  readonly phase?: WasmPluginSpecPhase;

  /**
   * The configuration that will be passed on to the plugin.
   *
   * @schema WasmPluginSpec#pluginConfig
   */
  readonly pluginConfig?: any;

  /**
   * @schema WasmPluginSpec#pluginName
   */
  readonly pluginName?: string;

  /**
   * Determines ordering of `WasmPlugins` in the same `phase`.
   *
   * @schema WasmPluginSpec#priority
   */
  readonly priority?: number;

  /**
   * @schema WasmPluginSpec#selector
   */
  readonly selector?: WasmPluginSpecSelector;

  /**
   * SHA256 checksum that will be used to verify Wasm module or OCI container.
   *
   * @schema WasmPluginSpec#sha256
   */
  readonly sha256?: string;

  /**
   * URL of a Wasm module or OCI container.
   *
   * @schema WasmPluginSpec#url
   */
  readonly url?: string;

  /**
   * @schema WasmPluginSpec#verificationKey
   */
  readonly verificationKey?: string;

  /**
   * Configuration for a Wasm VM.
   *
   * @schema WasmPluginSpec#vmConfig
   */
  readonly vmConfig?: WasmPluginSpecVmConfig;

}

/**
 * Converts an object of type 'WasmPluginSpec' to JSON representation.
 */
/* eslint-disable max-len, quote-props */
export function toJson_WasmPluginSpec(obj: WasmPluginSpec | undefined): Record<string, any> | undefined {
  if (obj === undefined) { return undefined; }
  const result = {
    'imagePullPolicy': obj.imagePullPolicy,
    'imagePullSecret': obj.imagePullSecret,
    'match': obj.match?.map(y => toJson_WasmPluginSpecMatch(y)),
    'phase': obj.phase,
    'pluginConfig': obj.pluginConfig,
    'pluginName': obj.pluginName,
    'priority': obj.priority,
    'selector': toJson_WasmPluginSpecSelector(obj.selector),
    'sha256': obj.sha256,
    'url': obj.url,
    'verificationKey': obj.verificationKey,
    'vmConfig': toJson_WasmPluginSpecVmConfig(obj.vmConfig),
  };
  // filter undefined values
  return Object.entries(result).reduce((r, i) => (i[1] === undefined) ? r : ({ ...r, [i[0]]: i[1] }), {});
}
/* eslint-enable max-len, quote-props */

/**
 * @schema WasmPluginSpecImagePullPolicy
 */
export enum WasmPluginSpecImagePullPolicy {
  /** UNSPECIFIED_POLICY */
  UNSPECIFIED_POLICY = "UNSPECIFIED_POLICY",
  /** IfNotPresent */
  IF_NOT_PRESENT = "IfNotPresent",
  /** Always */
  ALWAYS = "Always",
}

/**
 * @schema WasmPluginSpecMatch
 */
export interface WasmPluginSpecMatch {
  /**
   * Criteria for selecting traffic by their direction.
   *
   * @schema WasmPluginSpecMatch#mode
   */
  readonly mode?: WasmPluginSpecMatchMode;

  /**
   * Criteria for selecting traffic by their destination port.
   *
   * @schema WasmPluginSpecMatch#ports
   */
  readonly ports?: WasmPluginSpecMatchPorts[];

}

/**
 * Converts an object of type 'WasmPluginSpecMatch' to JSON representation.
 */
/* eslint-disable max-len, quote-props */
export function toJson_WasmPluginSpecMatch(obj: WasmPluginSpecMatch | undefined): Record<string, any> | undefined {
  if (obj === undefined) { return undefined; }
  const result = {
    'mode': obj.mode,
    'ports': obj.ports?.map(y => toJson_WasmPluginSpecMatchPorts(y)),
  };
  // filter undefined values
  return Object.entries(result).reduce((r, i) => (i[1] === undefined) ? r : ({ ...r, [i[0]]: i[1] }), {});
}
/* eslint-enable max-len, quote-props */

/**
 * Determines where in the filter chain this `WasmPlugin` is to be injected.
 *
 * @schema WasmPluginSpecPhase
 */
export enum WasmPluginSpecPhase {
  /** UNSPECIFIED_PHASE */
  UNSPECIFIED_PHASE = "UNSPECIFIED_PHASE",
  /** AUTHN */
  AUTHN = "AUTHN",
  /** AUTHZ */
  AUTHZ = "AUTHZ",
  /** STATS */
  STATS = "STATS",
}

/**
 * @schema WasmPluginSpecSelector
 */
export interface WasmPluginSpecSelector {
  /**
   * @schema WasmPluginSpecSelector#matchLabels
   */
  readonly matchLabels?: { [key: string]: string };

}

/**
 * Converts an object of type 'WasmPluginSpecSelector' to JSON representation.
 */
/* eslint-disable max-len, quote-props */
export function toJson_WasmPluginSpecSelector(obj: WasmPluginSpecSelector | undefined): Record<string, any> | undefined {
  if (obj === undefined) { return undefined; }
  const result = {
    'matchLabels': ((obj.matchLabels) === undefined) ? undefined : (Object.entries(obj.matchLabels).reduce((r, i) => (i[1] === undefined) ? r : ({ ...r, [i[0]]: i[1] }), {})),
  };
  // filter undefined values
  return Object.entries(result).reduce((r, i) => (i[1] === undefined) ? r : ({ ...r, [i[0]]: i[1] }), {});
}
/* eslint-enable max-len, quote-props */

/**
 * Configuration for a Wasm VM.
 *
 * @schema WasmPluginSpecVmConfig
 */
export interface WasmPluginSpecVmConfig {
  /**
   * Specifies environment variables to be injected to this VM.
   *
   * @schema WasmPluginSpecVmConfig#env
   */
  readonly env?: WasmPluginSpecVmConfigEnv[];

}

/**
 * Converts an object of type 'WasmPluginSpecVmConfig' to JSON representation.
 */
/* eslint-disable max-len, quote-props */
export function toJson_WasmPluginSpecVmConfig(obj: WasmPluginSpecVmConfig | undefined): Record<string, any> | undefined {
  if (obj === undefined) { return undefined; }
  const result = {
    'env': obj.env?.map(y => toJson_WasmPluginSpecVmConfigEnv(y)),
  };
  // filter undefined values
  return Object.entries(result).reduce((r, i) => (i[1] === undefined) ? r : ({ ...r, [i[0]]: i[1] }), {});
}
/* eslint-enable max-len, quote-props */

/**
 * Criteria for selecting traffic by their direction.
 *
 * @schema WasmPluginSpecMatchMode
 */
export enum WasmPluginSpecMatchMode {
  /** UNDEFINED */
  UNDEFINED = "UNDEFINED",
  /** CLIENT */
  CLIENT = "CLIENT",
  /** SERVER */
  SERVER = "SERVER",
  /** CLIENT_AND_SERVER */
  CLIENT_AND_SERVER = "CLIENT_AND_SERVER",
}

/**
 * @schema WasmPluginSpecMatchPorts
 */
export interface WasmPluginSpecMatchPorts {
  /**
   * @schema WasmPluginSpecMatchPorts#number
   */
  readonly number?: number;

}

/**
 * Converts an object of type 'WasmPluginSpecMatchPorts' to JSON representation.
 */
/* eslint-disable max-len, quote-props */
export function toJson_WasmPluginSpecMatchPorts(obj: WasmPluginSpecMatchPorts | undefined): Record<string, any> | undefined {
  if (obj === undefined) { return undefined; }
  const result = {
    'number': obj.number,
  };
  // filter undefined values
  return Object.entries(result).reduce((r, i) => (i[1] === undefined) ? r : ({ ...r, [i[0]]: i[1] }), {});
}
/* eslint-enable max-len, quote-props */

/**
 * @schema WasmPluginSpecVmConfigEnv
 */
export interface WasmPluginSpecVmConfigEnv {
  /**
   * @schema WasmPluginSpecVmConfigEnv#name
   */
  readonly name?: string;

  /**
   * Value for the environment variable.
   *
   * @schema WasmPluginSpecVmConfigEnv#value
   */
  readonly value?: string;

  /**
   * @schema WasmPluginSpecVmConfigEnv#valueFrom
   */
  readonly valueFrom?: WasmPluginSpecVmConfigEnvValueFrom;

}

/**
 * Converts an object of type 'WasmPluginSpecVmConfigEnv' to JSON representation.
 */
/* eslint-disable max-len, quote-props */
export function toJson_WasmPluginSpecVmConfigEnv(obj: WasmPluginSpecVmConfigEnv | undefined): Record<string, any> | undefined {
  if (obj === undefined) { return undefined; }
  const result = {
    'name': obj.name,
    'value': obj.value,
    'valueFrom': obj.valueFrom,
  };
  // filter undefined values
  return Object.entries(result).reduce((r, i) => (i[1] === undefined) ? r : ({ ...r, [i[0]]: i[1] }), {});
}
/* eslint-enable max-len, quote-props */

/**
 * @schema WasmPluginSpecVmConfigEnvValueFrom
 */
export enum WasmPluginSpecVmConfigEnvValueFrom {
  /** INLINE */
  INLINE = "INLINE",
  /** HOST */
  HOST = "HOST",
}

